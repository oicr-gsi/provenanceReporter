{% extends 'project_base.html' %}


{% block link %}
  <a href="{{ url_for('project_page', project_name=project['project_id']) }}">{{ project['project_id'] }}</a>
  <a href="{{ url_for('sequencing', project_name=project['project_id']) }}">Sequencing</a> 
  {% for i in pipelines %}
    {% if i in routes %}
      <a href="{{ url_for(routes[i], project_name=project['project_id']) }}">{{i}}</a>
    {% else %}
      <a href="#{{i}}">{{i}}</a>
    {% endif %}  
  {% endfor %}   
  <a class="split" href="{{ miso_link }}" target="_blank">{{ case }}</a> 
{% endblock %}


{% block content %}
  <div class="project_title">
    <p><span style="font-size:30px; font-style:normal;"> Shallow Whole Genome data </span></p>  
    <p><span style="font-size:16px; font-style:normal;"> Select ichorCNA workflow for the sample of interest.</span></p>  
  </div> 
  
  
  {% if swg %}
    <div class="somatic_block">
      <p style="font-size:22px; font-style:bold;">Sample: {{sample}}</p>
        {% for workflow_id in ordered_workflows[case][sample] %}
          <form method="POST" action = "">
            <div class="somatic_block">
              <table id="block_header_table">
                <td>
                  {{creation_dates[workflow_id] | readable_time}}
                </td>
                <td>
                  {% if status[case][sample][workflow_id] %}
                    <div class="tooltip">Release Status:<span class="tooltiptext">Input raw sequences released?</span></div> <span style="font-size:32px;color:#70db70">&#10004;</span>
                  {% else %}
                    <div class="tooltip">Release Status:<span class="tooltiptext">Input raw sequences released?</span></div> <span style="font-size:32px;color:#ff3300;">&#10006;</span>
                  {% endif %}
                <td>
                  <button class="select_button" id="select" type = "submit" value="submit">Select workflows</button>
                </td>
                <td>
                  <div class="download-dropdown">
                    <button class="download-dropbtn">Download json</button>
                      <div class="download-dropdown-content">
                        <button id="download_button"><a href="{{url_for('download_SWG_data', project_name=project['project_id'], case=case, sample=sample, workflow_id=workflow_id, selection='all')}}">all</a></button>
                        <button id="download_button"><a href="{{url_for('download_SWG_data', project_name=project['project_id'], case=case, sample=sample, workflow_id=workflow_id, selection='standard')}}">standard</a></button>
                      </div>
                  </div>
                </td>
              </table>
            
              <table id="block_table">
                <thead>
                  <th>workflow_run_id</th>
                  <th>workflow</th>
                  <th>platform</th>
                  <th>date</th>      
                  <th>file count</th>
                  <th>lane count</th>
                  <th>select</th> 
                </thead>     
                
                <tr>
                  <td>
                    <a class="workflow" href="{{ url_for('workflow', project_name=project['project_id'], pipeline='shallow_whole_genome', case=case, sample_pair=sample, workflow_id=workflow_id) }}">
                      <span style="font-size:16px; font-style:normal;">{{ workflow_id | shorten_workflow_id }}</span>
                    </a>
                  </td>
                  <td>
                      {{workflow_names[workflow_id][0]}}
                  </td>
                  <td>
                    {% for i in swg[case][sample][workflow_id]['platform'] | list %}
                      {{i}}
                    {% endfor %} 
                  </td>
                  <td>
                     {{creation_dates[workflow_id] | readable_time}}
                  </td>
                  <td>
                    {{file_counts[workflow_id]}}  
                  </td>
                  <td>
                    {{amount_data[workflow_id]}}
                  </td>
                  <td>
                    {% if selected[workflow_id] %}
                      <input class="checkbox" type="checkbox" name="workflow" value="{{workflow_id}}" id="workflow" checked/>
                    {% else %}
                      <input class="checkbox" type="checkbox" name="workflow" value="{{workflow_id}}" id="workflow"/>  
                    {% endif %}    
                  </td>
                </tr>
              </table>
              </div>
          </form>
        {% endfor %}
    </div> 
  {% endif %} 

<footer>
  <p style="margin-left:auto;margin-right:auto; margin-top:150px; padding-bottom:0px;max-width:300px;position:relative;font-size:16px; font-style:normal; font-family: Arial, Helvetica, sans-serif; color: #A8A8A8;"> Data last updated {{project['last_updated'].split('_')[0]}} </p>
</footer>
      
{% endblock %}
    

